{"metadata":{"kernelspec":{"language":"python","display_name":"Python 3","name":"python3"},"language_info":{"pygments_lexer":"ipython3","nbconvert_exporter":"python","version":"3.6.4","file_extension":".py","codemirror_mode":{"name":"ipython","version":3},"name":"python","mimetype":"text/x-python"},"colab":{"provenance":[{"file_id":"https://storage.googleapis.com/kaggle-colab-exported-notebooks/tweets-chatgpt-predict-engagement-0acae6c6-13ff-4103-9880-5912e8996ac6.ipynb?X-Goog-Algorithm=GOOG4-RSA-SHA256&X-Goog-Credential=gcp-kaggle-com%40kaggle-161607.iam.gserviceaccount.com/20240325/auto/storage/goog4_request&X-Goog-Date=20240325T143319Z&X-Goog-Expires=259200&X-Goog-SignedHeaders=host&X-Goog-Signature=271a3ce8d226a7610a4fa56bd2061a9ff69be86867a074f3b61fced7ef79a45d185751c263028775e69548eb2843645fff081d732474fefccf9644cf5588ae482a046b90607fd1e0c2cf001bbe7bd3522dcf955d53886ff7f276d6bf8a857044c987059feb07caac22e59d078977c011d6e94653642e110e05f53204341a313a7bad29f0da75b2559b98cef8b839b843e57c1e7e4da975ed7e150148879f3fb3106064bf4649d5b82cd112cd8dd8a0605fb9e0fea806a7c7f798bde186458a4ac7066007ac5aecff989e9000e215a4974a72786ef08983a45d859032ad505a0af84509257a93cb298d2019026262b18eebfb7f363e9671c7398f431d0ace0e0d","timestamp":1711377235812}]},"widgets":{"application/vnd.jupyter.widget-state+json":{"e8070aad71f04f60b6f5fed12dd3ee43":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_bc47e6a34f2a4b65b5f6f3be5358ed88","IPY_MODEL_90e4fb0ab5bd43a8a50c919255a046ab","IPY_MODEL_4b86bbfc558042c182a8195844bc01b0"],"layout":"IPY_MODEL_a102afbb46c147f690e0e6d373ab1032"}},"bc47e6a34f2a4b65b5f6f3be5358ed88":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_764c26d5827a4b4eb20d128b8611341b","placeholder":"​","style":"IPY_MODEL_7d77a08a653a412a83ee5bd47fdac960","value":"100%"}},"90e4fb0ab5bd43a8a50c919255a046ab":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_6a543dfc2c84441ca474f6855b1201ee","max":903,"min":0,"orientation":"horizontal","style":"IPY_MODEL_e6d81812e66f4d249388eb5b12505d89","value":903}},"4b86bbfc558042c182a8195844bc01b0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_1ab2d2a4747644f0811b17c8b7b4ff40","placeholder":"​","style":"IPY_MODEL_384224450cf04c8b824de72153cda370","value":" 903/903 [06:15&lt;00:00,  2.98it/s]"}},"a102afbb46c147f690e0e6d373ab1032":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"764c26d5827a4b4eb20d128b8611341b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7d77a08a653a412a83ee5bd47fdac960":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6a543dfc2c84441ca474f6855b1201ee":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e6d81812e66f4d249388eb5b12505d89":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"1ab2d2a4747644f0811b17c8b7b4ff40":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"384224450cf04c8b824de72153cda370":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"67f95a993ea44091b4bc71ddf567808d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_b8be8df09afc4265b44e24aec52ac4b8","IPY_MODEL_4bfb282e6ea449269bcce32fab6458a9","IPY_MODEL_a9699e888d284822b9ad54ef322d28de"],"layout":"IPY_MODEL_7e830089b1b849b8a6b46e8b5c53e681"}},"b8be8df09afc4265b44e24aec52ac4b8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_927d7999dcdc4c27b73ad53167430d43","placeholder":"​","style":"IPY_MODEL_f9507c9adb92478daac92472fd8d7796","value":"100%"}},"4bfb282e6ea449269bcce32fab6458a9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_77f8d1b1603447308a4dee5731b523e1","max":722,"min":0,"orientation":"horizontal","style":"IPY_MODEL_1de7abbb73704162bf6543814ff52ca5","value":722}},"a9699e888d284822b9ad54ef322d28de":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5ca4606e6aba40a2afa79386a08552e7","placeholder":"​","style":"IPY_MODEL_a4db10346569453d915dfa8ffa9c3e5d","value":" 722/722 [03:27&lt;00:00,  4.53it/s]"}},"7e830089b1b849b8a6b46e8b5c53e681":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"927d7999dcdc4c27b73ad53167430d43":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f9507c9adb92478daac92472fd8d7796":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"77f8d1b1603447308a4dee5731b523e1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1de7abbb73704162bf6543814ff52ca5":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5ca4606e6aba40a2afa79386a08552e7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a4db10346569453d915dfa8ffa9c3e5d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0f4a76c4ec22475abb640fb719f0952d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_50d4bfee4561492988fdda04dfbd3e6a","IPY_MODEL_d8a8908dd7244c8786872ccb6f18c8ca","IPY_MODEL_b45084b3f3f6455f9de0f87aa07cb7d3"],"layout":"IPY_MODEL_d73b5f28990f41d68d46de2b1e45238d"}},"50d4bfee4561492988fdda04dfbd3e6a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b32059815e67495a85d274fe2288dbea","placeholder":"​","style":"IPY_MODEL_f8d77bdeb213445db9e0a30f25ab724b","value":"100%"}},"d8a8908dd7244c8786872ccb6f18c8ca":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_c81f80a8bc6d4654b1b1d0270234cd68","max":181,"min":0,"orientation":"horizontal","style":"IPY_MODEL_6f9f8985b7124870a05b38da58022fae","value":181}},"b45084b3f3f6455f9de0f87aa07cb7d3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_27edbd2f53774e22981cb5448166cb49","placeholder":"​","style":"IPY_MODEL_3e2d06fe3e304026b44e47d7e4b418a9","value":" 181/181 [00:50&lt;00:00,  4.83it/s]"}},"d73b5f28990f41d68d46de2b1e45238d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b32059815e67495a85d274fe2288dbea":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f8d77bdeb213445db9e0a30f25ab724b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c81f80a8bc6d4654b1b1d0270234cd68":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6f9f8985b7124870a05b38da58022fae":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"27edbd2f53774e22981cb5448166cb49":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3e2d06fe3e304026b44e47d7e4b418a9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f9ef1a7b74f94ebaac593325d10802db":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_7f5c368516d745c9a0765c79023fa4ed","IPY_MODEL_478387a5af0d400aa541b2c3039f6e89","IPY_MODEL_cf86aba72b854c91bd3b4f4e96d1fbf3"],"layout":"IPY_MODEL_eacf26a1cb93499e8e2c1a54640eef9d"}},"7f5c368516d745c9a0765c79023fa4ed":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_dc4619e9680745c883b9cb14f4b2a98e","placeholder":"​","style":"IPY_MODEL_2dd53f300ed54d8f8813b189e6c23333","value":"pytorch_model.bin: 100%"}},"478387a5af0d400aa541b2c3039f6e89":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_2543c9c7b9ec45149e5fc3ebf306ec9f","max":542529064,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f3e25cd49ae2438ca0eb69543a0fec8e","value":542529064}},"cf86aba72b854c91bd3b4f4e96d1fbf3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0b7ca8608f5e44a2b855c80a31b34449","placeholder":"​","style":"IPY_MODEL_ef5d078720a644c3b645d8fa717a6e15","value":" 543M/543M [00:06&lt;00:00, 133MB/s]"}},"eacf26a1cb93499e8e2c1a54640eef9d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"dc4619e9680745c883b9cb14f4b2a98e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2dd53f300ed54d8f8813b189e6c23333":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2543c9c7b9ec45149e5fc3ebf306ec9f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f3e25cd49ae2438ca0eb69543a0fec8e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"0b7ca8608f5e44a2b855c80a31b34449":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ef5d078720a644c3b645d8fa717a6e15":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9d9cd5279a57407b860c95af5b229a48":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_896b8dfd7c4f4b71b2a6745beed62eba","IPY_MODEL_72633ee9c2564491842f3b67cbd773a2","IPY_MODEL_51cad8216702411a90e411954d437107"],"layout":"IPY_MODEL_b97722b9e7a944da8d84c1c623d3c0a3"}},"896b8dfd7c4f4b71b2a6745beed62eba":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_7058a0cf32774b398f23c36634c48edc","placeholder":"​","style":"IPY_MODEL_f4f6d3423cd5440eb42a3c35f4d42c8f","value":"Downloading builder script: "}},"72633ee9c2564491842f3b67cbd773a2":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_bea7fed160e14bc3b361ca766832fbef","max":1652,"min":0,"orientation":"horizontal","style":"IPY_MODEL_9f33c4204db24c55a3d86edeeba7457d","value":1652}},"51cad8216702411a90e411954d437107":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f894846883ad41aebce5a5f3a3c2c721","placeholder":"​","style":"IPY_MODEL_1eea605605d24707a48e9c3c962d084f","value":" 4.21k/? [00:00&lt;00:00, 214kB/s]"}},"b97722b9e7a944da8d84c1c623d3c0a3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7058a0cf32774b398f23c36634c48edc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f4f6d3423cd5440eb42a3c35f4d42c8f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"bea7fed160e14bc3b361ca766832fbef":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9f33c4204db24c55a3d86edeeba7457d":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"f894846883ad41aebce5a5f3a3c2c721":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1eea605605d24707a48e9c3c962d084f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"nbformat_minor":0,"nbformat":4,"cells":[{"source":["\n","# IMPORTANT: RUN THIS CELL IN ORDER TO IMPORT YOUR KAGGLE DATA SOURCES\n","# TO THE CORRECT LOCATION (/kaggle/input) IN YOUR NOTEBOOK,\n","# THEN FEEL FREE TO DELETE THIS CELL.\n","# NOTE: THIS NOTEBOOK ENVIRONMENT DIFFERS FROM KAGGLE'S PYTHON\n","# ENVIRONMENT SO THERE MAY BE MISSING LIBRARIES USED BY YOUR\n","# NOTEBOOK.\n","\n","import os\n","import sys\n","from tempfile import NamedTemporaryFile\n","from urllib.request import urlopen\n","from urllib.parse import unquote, urlparse\n","from urllib.error import HTTPError\n","from zipfile import ZipFile\n","import tarfile\n","import shutil\n","\n","CHUNK_SIZE = 40960\n","DATA_SOURCE_MAPPING = '500k-chatgpt-tweets-jan-mar-2023:https%3A%2F%2Fstorage.googleapis.com%2Fkaggle-data-sets%2F3117560%2F5373178%2Fbundle%2Farchive.zip%3FX-Goog-Algorithm%3DGOOG4-RSA-SHA256%26X-Goog-Credential%3Dgcp-kaggle-com%2540kaggle-161607.iam.gserviceaccount.com%252F20240325%252Fauto%252Fstorage%252Fgoog4_request%26X-Goog-Date%3D20240325T143319Z%26X-Goog-Expires%3D259200%26X-Goog-SignedHeaders%3Dhost%26X-Goog-Signature%3D75e142b71ba028789fd539a2a878e27ec0ab21a4e72b4aa3c44521cd90917d9d4a9730cffe528d386b84c1905c4c2cb74c25062fdc0a8fcb398b2a796dccacd7f76f1fe2a83b783d82a539dccfbcb8d8a92c927a02e82e30c14c8ba75885f161b1b520ad4a5482a218863aae589f4ae594372fe1b816e79f6d9e7015fd690087b5831d1856b91a7bf7399bfc09cc040c23ba7d3800e786605a857b2689f6f0a8dda675823f7ce2b61a6bf7d62ff8804b399db2f231989bb72152fb1c0663eb5e50cfd40ca30d390307e5438105918d68b98eb68d9c3b810708eea90dd9b089dc0d1f3fe6a0eb58160ddc2d5d1e24199813312c5ae9e8186b4cf8b931af16a1dc'\n","\n","KAGGLE_INPUT_PATH='/kaggle/input'\n","KAGGLE_WORKING_PATH='/kaggle/working'\n","KAGGLE_SYMLINK='kaggle'\n","\n","!umount /kaggle/input/ 2> /dev/null\n","shutil.rmtree('/kaggle/input', ignore_errors=True)\n","os.makedirs(KAGGLE_INPUT_PATH, 0o777, exist_ok=True)\n","os.makedirs(KAGGLE_WORKING_PATH, 0o777, exist_ok=True)\n","\n","try:\n","  os.symlink(KAGGLE_INPUT_PATH, os.path.join(\"..\", 'input'), target_is_directory=True)\n","except FileExistsError:\n","  pass\n","try:\n","  os.symlink(KAGGLE_WORKING_PATH, os.path.join(\"..\", 'working'), target_is_directory=True)\n","except FileExistsError:\n","  pass\n","\n","for data_source_mapping in DATA_SOURCE_MAPPING.split(','):\n","    directory, download_url_encoded = data_source_mapping.split(':')\n","    download_url = unquote(download_url_encoded)\n","    filename = urlparse(download_url).path\n","    destination_path = os.path.join(KAGGLE_INPUT_PATH, directory)\n","    try:\n","        with urlopen(download_url) as fileres, NamedTemporaryFile() as tfile:\n","            total_length = fileres.headers['content-length']\n","            print(f'Downloading {directory}, {total_length} bytes compressed')\n","            dl = 0\n","            data = fileres.read(CHUNK_SIZE)\n","            while len(data) > 0:\n","                dl += len(data)\n","                tfile.write(data)\n","                done = int(50 * dl / int(total_length))\n","                sys.stdout.write(f\"\\r[{'=' * done}{' ' * (50-done)}] {dl} bytes downloaded\")\n","                sys.stdout.flush()\n","                data = fileres.read(CHUNK_SIZE)\n","            if filename.endswith('.zip'):\n","              with ZipFile(tfile) as zfile:\n","                zfile.extractall(destination_path)\n","            else:\n","              with tarfile.open(tfile.name) as tarfile:\n","                tarfile.extractall(destination_path)\n","            print(f'\\nDownloaded and uncompressed: {directory}')\n","    except HTTPError as e:\n","        print(f'Failed to load (likely expired) {download_url} to path {destination_path}')\n","        continue\n","    except OSError as e:\n","        print(f'Failed to load {download_url} to path {destination_path}')\n","        continue\n","\n","print('Data source import complete.')\n"],"metadata":{"id":"xDHGNJMpB7ke","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1711377256822,"user_tz":240,"elapsed":12098,"user":{"displayName":"Mei Li","userId":"04999520085843898387"}},"outputId":"90800659-5905-474f-faa2-f8f28cf04b21"},"cell_type":"code","outputs":[{"output_type":"stream","name":"stdout","text":["Downloading 500k-chatgpt-tweets-jan-mar-2023, 49816658 bytes compressed\n","[==================================================] 49816658 bytes downloaded\n","Downloaded and uncompressed: 500k-chatgpt-tweets-jan-mar-2023\n","Data source import complete.\n"]}],"execution_count":null},{"cell_type":"code","source":["!pip install -q mlflow nlp"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T07:49:24.91178Z","iopub.execute_input":"2023-05-21T07:49:24.912179Z","iopub.status.idle":"2023-05-21T07:49:42.921039Z","shell.execute_reply.started":"2023-05-21T07:49:24.912148Z","shell.execute_reply":"2023-05-21T07:49:42.919866Z"},"trusted":true,"id":"-vVFZ1WoB7kf","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1711377308712,"user_tz":240,"elapsed":19772,"user":{"displayName":"Mei Li","userId":"04999520085843898387"}},"outputId":"f0791e3d-fb86-4b76-81c4-455407042c8e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m19.7/19.7 MB\u001b[0m \u001b[31m13.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.7/1.7 MB\u001b[0m \u001b[31m14.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m195.4/195.4 kB\u001b[0m \u001b[31m12.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m53.0/53.0 kB\u001b[0m \u001b[31m4.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m233.4/233.4 kB\u001b[0m \u001b[31m13.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m147.6/147.6 kB\u001b[0m \u001b[31m13.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m128.2/128.2 kB\u001b[0m \u001b[31m9.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m80.2/80.2 kB\u001b[0m \u001b[31m7.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m116.3/116.3 kB\u001b[0m \u001b[31m11.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m194.1/194.1 kB\u001b[0m \u001b[31m14.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m78.7/78.7 kB\u001b[0m \u001b[31m8.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m62.7/62.7 kB\u001b[0m \u001b[31m6.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m202.9/202.9 kB\u001b[0m \u001b[31m14.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m52.8/52.8 kB\u001b[0m \u001b[31m6.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h"]}]},{"cell_type":"code","source":["!pip install datasets"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vezJ_2ydCpxD","executionInfo":{"status":"ok","timestamp":1711377423301,"user_tz":240,"elapsed":15616,"user":{"displayName":"Mei Li","userId":"04999520085843898387"}},"outputId":"b8b3face-3980-4513-8d4c-c1abf3f2d4fa"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting datasets\n","  Downloading datasets-2.18.0-py3-none-any.whl (510 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m510.5/510.5 kB\u001b[0m \u001b[31m2.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from datasets) (3.13.1)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from datasets) (1.25.2)\n","Requirement already satisfied: pyarrow>=12.0.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (14.0.2)\n","Requirement already satisfied: pyarrow-hotfix in /usr/local/lib/python3.10/dist-packages (from datasets) (0.6)\n","Requirement already satisfied: dill<0.3.9,>=0.3.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (0.3.8)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from datasets) (1.5.3)\n","Requirement already satisfied: requests>=2.19.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (2.31.0)\n","Requirement already satisfied: tqdm>=4.62.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (4.66.2)\n","Requirement already satisfied: xxhash in /usr/local/lib/python3.10/dist-packages (from datasets) (3.4.1)\n","Collecting multiprocess (from datasets)\n","  Downloading multiprocess-0.70.16-py310-none-any.whl (134 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m134.8/134.8 kB\u001b[0m \u001b[31m7.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: fsspec[http]<=2024.2.0,>=2023.1.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (2023.6.0)\n","Requirement already satisfied: aiohttp in /usr/local/lib/python3.10/dist-packages (from datasets) (3.9.3)\n","Requirement already satisfied: huggingface-hub>=0.19.4 in /usr/local/lib/python3.10/dist-packages (from datasets) (0.20.3)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from datasets) (23.2)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (6.0.1)\n","Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (1.3.1)\n","Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (23.2.0)\n","Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (1.4.1)\n","Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (6.0.5)\n","Requirement already satisfied: yarl<2.0,>=1.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (1.9.4)\n","Requirement already satisfied: async-timeout<5.0,>=4.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (4.0.3)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub>=0.19.4->datasets) (4.10.0)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (3.6)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (2024.2.2)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2023.4)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.1->pandas->datasets) (1.16.0)\n","Installing collected packages: multiprocess, datasets\n","Successfully installed datasets-2.18.0 multiprocess-0.70.16\n"]}]},{"cell_type":"code","source":["#imports\n","import pandas as pd\n","import gc\n","import re\n","import numpy as np\n","import torch\n","from transformers import AutoModel, AutoTokenizer\n","from transformers import TextDataset, LineByLineTextDataset, DataCollatorForLanguageModeling, \\\n","pipeline, Trainer, TrainingArguments, DataCollatorWithPadding\n","from transformers import AutoModelForSequenceClassification\n","from nlp import Dataset\n","from imblearn.over_sampling import RandomOverSampler\n","import datasets\n","from transformers import pipeline\n","\n","from tqdm import tqdm\n","tqdm.pandas()"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T07:49:42.925165Z","iopub.execute_input":"2023-05-21T07:49:42.925465Z","iopub.status.idle":"2023-05-21T07:49:58.126522Z","shell.execute_reply.started":"2023-05-21T07:49:42.925435Z","shell.execute_reply":"2023-05-21T07:49:58.125544Z"},"trusted":true,"id":"I-IaZnE3B7kf"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# set parameters\n","train_fraction = 0.8 # fraction of a dataset used for training (the rest used for validation)\n","max_len = 280 # max chars in a tweet\n","num_train_epochs = 2 # epochs to train\n","batch_size = 64 # batch size for training and validation\n","warmup_steps = 50\n","weight_decay = 0.02\n","min_engagement = 10 # use it to create a binary label\n","n_tweets = None #10**5 # if not None, use a smaller sample of tweets\n","BERT_MODEL = \"vinai/bertweet-base\" # BERTweet\n","repo_id = \"dima806/chatgpt-tweets-engagement\"\n","model_saved_path = './results'\n","label_column = \"label\" # label column\n","text_column = \"content\" # text column with tweet texts\n","top_tweets_label = 0.05 # use these fraction of tweets with the highest engagement as ENGAGED label"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T07:49:58.127774Z","iopub.execute_input":"2023-05-21T07:49:58.128811Z","iopub.status.idle":"2023-05-21T07:49:58.138009Z","shell.execute_reply.started":"2023-05-21T07:49:58.128783Z","shell.execute_reply":"2023-05-21T07:49:58.13651Z"},"trusted":true,"id":"wFPybVXMB7kf"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# load initial tweets\n","df = pd.read_csv(\"//kaggle/input/500k-chatgpt-tweets-jan-mar-2023/Twitter Jan Mar.csv\").drop_duplicates()\n","print(df.shape)\n","df.head().T"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T07:49:58.140738Z","iopub.execute_input":"2023-05-21T07:49:58.14185Z","iopub.status.idle":"2023-05-21T07:50:02.600973Z","shell.execute_reply.started":"2023-05-21T07:49:58.141816Z","shell.execute_reply":"2023-05-21T07:50:02.599766Z"},"trusted":true,"id":"_Ga7ViOxB7kg","colab":{"base_uri":"https://localhost:8080/","height":273},"executionInfo":{"status":"ok","timestamp":1711377457741,"user_tz":240,"elapsed":5106,"user":{"displayName":"Mei Li","userId":"04999520085843898387"}},"outputId":"3c49e236-9b55-43ee-ba75-a80d4b424675"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["(500036, 6)\n"]},{"output_type":"execute_result","data":{"text/plain":["                                                               0  \\\n","date                                   2023-03-29 22:58:21+00:00   \n","id                                           1641213230730051584   \n","content        Free AI marketing and automation tools, strate...   \n","username                                          RealProfitPros   \n","like_count                                                   0.0   \n","retweet_count                                                0.0   \n","\n","                                                      1  \\\n","date                          2023-03-29 22:58:18+00:00   \n","id                                  1641213218520481805   \n","content        @MecoleHardman4 Chat GPT says it’s 15. 😂   \n","username                                   AmyLouWho321   \n","like_count                                          0.0   \n","retweet_count                                       0.0   \n","\n","                                                               2  \\\n","date                                   2023-03-29 22:57:53+00:00   \n","id                                           1641213115684536323   \n","content        https://t.co/FjJSprt0te - Chat with any PDF!\\n...   \n","username                                              yjleon1976   \n","like_count                                                   0.0   \n","retweet_count                                                0.0   \n","\n","                                                               3  \\\n","date                                   2023-03-29 22:57:52+00:00   \n","id                                           1641213110915571715   \n","content        AI muses: \"In the court of life, we must all f...   \n","username                                          ChatGPT_Thinks   \n","like_count                                                   0.0   \n","retweet_count                                                0.0   \n","\n","                                                               4  \n","date                                   2023-03-29 22:57:26+00:00  \n","id                                           1641213003260633088  \n","content        Most people haven't heard of Chat GPT yet.\\nFi...  \n","username                                           nikocosmonaut  \n","like_count                                                   0.0  \n","retweet_count                                                0.0  "],"text/html":["\n","  <div id=\"df-769ff1fc-06ae-4905-97b2-6acb210d849c\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>0</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>date</th>\n","      <td>2023-03-29 22:58:21+00:00</td>\n","      <td>2023-03-29 22:58:18+00:00</td>\n","      <td>2023-03-29 22:57:53+00:00</td>\n","      <td>2023-03-29 22:57:52+00:00</td>\n","      <td>2023-03-29 22:57:26+00:00</td>\n","    </tr>\n","    <tr>\n","      <th>id</th>\n","      <td>1641213230730051584</td>\n","      <td>1641213218520481805</td>\n","      <td>1641213115684536323</td>\n","      <td>1641213110915571715</td>\n","      <td>1641213003260633088</td>\n","    </tr>\n","    <tr>\n","      <th>content</th>\n","      <td>Free AI marketing and automation tools, strate...</td>\n","      <td>@MecoleHardman4 Chat GPT says it’s 15. 😂</td>\n","      <td>https://t.co/FjJSprt0te - Chat with any PDF!\\n...</td>\n","      <td>AI muses: \"In the court of life, we must all f...</td>\n","      <td>Most people haven't heard of Chat GPT yet.\\nFi...</td>\n","    </tr>\n","    <tr>\n","      <th>username</th>\n","      <td>RealProfitPros</td>\n","      <td>AmyLouWho321</td>\n","      <td>yjleon1976</td>\n","      <td>ChatGPT_Thinks</td>\n","      <td>nikocosmonaut</td>\n","    </tr>\n","    <tr>\n","      <th>like_count</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>retweet_count</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-769ff1fc-06ae-4905-97b2-6acb210d849c')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-769ff1fc-06ae-4905-97b2-6acb210d849c button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-769ff1fc-06ae-4905-97b2-6acb210d849c');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-48a84eb6-0278-40d6-ab73-f4a0a9359a8b\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-48a84eb6-0278-40d6-ab73-f4a0a9359a8b')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-48a84eb6-0278-40d6-ab73-f4a0a9359a8b button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"df"}},"metadata":{},"execution_count":7}]},{"cell_type":"code","source":["# create target\n","df[label_column] = df['retweet_count'] + df['like_count']\n","df = df[[text_column, label_column]].drop_duplicates()\n","# update https://stackoverflow.com/a/54206513\n","URL_REGEX = re.compile(\"http[s]?://\\S+\")\n","def clean_tweet(tweet):\n","    # replace urls with URL token\n","    try:\n","        tweet = re.sub(URL_REGEX, 'url ', tweet)  # replace urls with url. Assumes that the mention of a url is significant\n","    except:\n","        pass\n","    return str(tweet).strip()\n","\n","df[text_column] = df[text_column].progress_apply(clean_tweet)\n","df = df[df[text_column].apply(len) < max_len]\n","if n_tweets:\n","    df = df.sample(n_tweets) # limit number of tweets to speed up the analysis\n","# select top tweets as positively engaged\n","threshold = df[label_column].quantile(1-top_tweets_label)\n","print(f\"Label threshold engagement is {threshold}\")\n","df[label_column] = df[label_column].apply(lambda x: 1 if x >= threshold else 0)\n","print(df.shape)\n","df.sample(20)"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T07:50:02.602625Z","iopub.execute_input":"2023-05-21T07:50:02.602995Z","iopub.status.idle":"2023-05-21T07:50:06.00339Z","shell.execute_reply.started":"2023-05-21T07:50:02.602963Z","shell.execute_reply":"2023-05-21T07:50:06.002506Z"},"trusted":true,"id":"2_2oKGHjB7kg","colab":{"base_uri":"https://localhost:8080/","height":730},"executionInfo":{"status":"ok","timestamp":1711377468064,"user_tz":240,"elapsed":2770,"user":{"displayName":"Mei Li","userId":"04999520085843898387"}},"outputId":"b44185f7-d73b-4ec3-cb35-5c878938e678"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 496146/496146 [00:01<00:00, 288269.57it/s]\n"]},{"output_type":"stream","name":"stdout","text":["Label threshold engagement is 15.0\n","(475187, 2)\n"]},{"output_type":"execute_result","data":{"text/plain":["                                                  content  label\n","104135  Another major firm eyeing use of $BIDU’s #Erni...      0\n","114176               @profoundlyyyy Did you ask chat GPT?      0\n","318513  How to offer training and consulting services ...      0\n","377296        #ChatGPT thank u for my pitch deck bullets.      0\n","236839  @rmarkdown #ChatGpt sometimes lies about funct...      0\n","470642  Do you want feedback on your #rstats code but ...      1\n","453726  The best application i have ever used is  @WeT...      0\n","410301                      @nabeelqu I love #ChatGPT url      0\n","327534  Has your school issued an official stance on t...      0\n","394080  “Maybe this is the cusp of a new utopia, in wh...      0\n","231065  Today, I was open browser and do research abou...      0\n","467334  As exciting as this is for #ChatGPT lovers, it...      0\n","457060  @No1DogMum That awkward moment when you realis...      0\n","50613   #JeffreyEpstein #blackbook #EpsteinClientList ...      0\n","398256  One day you're going to wake up and Chat GPT w...      1\n","107726  Chat GPT-4 might actually be the new thing tha...      0\n","243826  #ChatGPT after seeing others do it thought I’d...      0\n","193204  Then paste the second section.\\n\\nSo lines 22 ...      0\n","474808  #AI #gamedev #coding #unity3d #AI_gamedev #mad...      0\n","182279  Meta's metaverse: On this evidence, the future...      0"],"text/html":["\n","  <div id=\"df-9e9ca278-ced0-46c5-8598-4e375755c4b4\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>content</th>\n","      <th>label</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>104135</th>\n","      <td>Another major firm eyeing use of $BIDU’s #Erni...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>114176</th>\n","      <td>@profoundlyyyy Did you ask chat GPT?</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>318513</th>\n","      <td>How to offer training and consulting services ...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>377296</th>\n","      <td>#ChatGPT thank u for my pitch deck bullets.</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>236839</th>\n","      <td>@rmarkdown #ChatGpt sometimes lies about funct...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>470642</th>\n","      <td>Do you want feedback on your #rstats code but ...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>453726</th>\n","      <td>The best application i have ever used is  @WeT...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>410301</th>\n","      <td>@nabeelqu I love #ChatGPT url</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>327534</th>\n","      <td>Has your school issued an official stance on t...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>394080</th>\n","      <td>“Maybe this is the cusp of a new utopia, in wh...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>231065</th>\n","      <td>Today, I was open browser and do research abou...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>467334</th>\n","      <td>As exciting as this is for #ChatGPT lovers, it...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>457060</th>\n","      <td>@No1DogMum That awkward moment when you realis...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>50613</th>\n","      <td>#JeffreyEpstein #blackbook #EpsteinClientList ...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>398256</th>\n","      <td>One day you're going to wake up and Chat GPT w...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>107726</th>\n","      <td>Chat GPT-4 might actually be the new thing tha...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>243826</th>\n","      <td>#ChatGPT after seeing others do it thought I’d...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>193204</th>\n","      <td>Then paste the second section.\\n\\nSo lines 22 ...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>474808</th>\n","      <td>#AI #gamedev #coding #unity3d #AI_gamedev #mad...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>182279</th>\n","      <td>Meta's metaverse: On this evidence, the future...</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-9e9ca278-ced0-46c5-8598-4e375755c4b4')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-9e9ca278-ced0-46c5-8598-4e375755c4b4 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-9e9ca278-ced0-46c5-8598-4e375755c4b4');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-f7b32242-0959-428f-8055-f2f58a2b7859\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-f7b32242-0959-428f-8055-f2f58a2b7859')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-f7b32242-0959-428f-8055-f2f58a2b7859 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","summary":"{\n  \"name\": \"df\",\n  \"rows\": 20,\n  \"fields\": [\n    {\n      \"column\": \"content\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 20,\n        \"samples\": [\n          \"Another major firm eyeing use of $BIDU\\u2019s #ErnieBOT. Positive reception of China\\u2019s leading #ChatGPT counterpart isn\\u2019t reflecting on share price right now. - KINGDEE INT'L Running Scenario Testing on 'Ernie Bot', Highly Confident in Domestic Biz  url\",\n          \"Then paste the second section.\\n\\nSo lines 22 to 36 into #ChatGPT \\n\\nChange lines 32 and 34 to what you want\\n\\nWhen you have done this you will have 5 prompts ready to go for #midjourney url\",\n          \"Chat GPT-4 might actually be the new thing that will change how things are done on the Internet. Kudos to the people behind this technology.\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"label\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 0,\n        \"max\": 1,\n        \"num_unique_values\": 2,\n        \"samples\": [\n          1,\n          0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":8}]},{"cell_type":"code","source":["df[label_column].value_counts()"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T07:50:06.007345Z","iopub.execute_input":"2023-05-21T07:50:06.008252Z","iopub.status.idle":"2023-05-21T07:50:06.027118Z","shell.execute_reply.started":"2023-05-21T07:50:06.008216Z","shell.execute_reply":"2023-05-21T07:50:06.026276Z"},"trusted":true,"id":"Dh5yiigIB7kg","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1711378496957,"user_tz":240,"elapsed":553,"user":{"displayName":"Mei Li","userId":"04999520085843898387"}},"outputId":"dc0a7ce6-71f2-4d88-e522-18f00bc43eea"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0    451005\n","1     24182\n","Name: label, dtype: int64"]},"metadata":{},"execution_count":9}]},{"cell_type":"code","source":["# random oversampling of minority class - not needed because of adding weights to minority class\n","y = df[[label_column]]\n","df = df.drop([label_column], axis=1)\n","ros = RandomOverSampler(random_state=83)\n","df, y_resampled = ros.fit_resample(df, y)\n","del y\n","df[label_column] = y_resampled\n","del y_resampled\n","gc.collect()"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T07:50:06.03142Z","iopub.execute_input":"2023-05-21T07:50:06.034017Z","iopub.status.idle":"2023-05-21T07:50:07.004654Z","shell.execute_reply.started":"2023-05-21T07:50:06.033982Z","shell.execute_reply":"2023-05-21T07:50:07.003737Z"},"trusted":true,"id":"28nck7eIB7kg","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1711378501479,"user_tz":240,"elapsed":2531,"user":{"displayName":"Mei Li","userId":"04999520085843898387"}},"outputId":"f0dece54-1fd2-4c0e-a503-fbda3284d5a2"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["68"]},"metadata":{},"execution_count":10}]},{"cell_type":"code","source":["tweet_dataset = Dataset.from_pandas(df)"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T07:50:07.005976Z","iopub.execute_input":"2023-05-21T07:50:07.006331Z","iopub.status.idle":"2023-05-21T07:50:07.518826Z","shell.execute_reply.started":"2023-05-21T07:50:07.006298Z","shell.execute_reply":"2023-05-21T07:50:07.517856Z"},"trusted":true,"id":"MMeyuJyWB7kg"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["del df\n","gc.collect()"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T07:50:07.522398Z","iopub.execute_input":"2023-05-21T07:50:07.523247Z","iopub.status.idle":"2023-05-21T07:50:07.901101Z","shell.execute_reply.started":"2023-05-21T07:50:07.523211Z","shell.execute_reply":"2023-05-21T07:50:07.900217Z"},"trusted":true,"id":"dQnG8Dc1B7kg","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1711378511540,"user_tz":240,"elapsed":105,"user":{"displayName":"Mei Li","userId":"04999520085843898387"}},"outputId":"33dbff03-4d63-4342-c7af-9ecaa90963a7"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0"]},"metadata":{},"execution_count":12}]},{"cell_type":"code","source":["!pip install emoji==0.6.0"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"D7i5-CohG-Ow","executionInfo":{"status":"ok","timestamp":1711378548592,"user_tz":240,"elapsed":15814,"user":{"displayName":"Mei Li","userId":"04999520085843898387"}},"outputId":"854845c4-74a8-46dc-912a-0d6274545197"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting emoji==0.6.0\n","  Downloading emoji-0.6.0.tar.gz (51 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m51.0/51.0 kB\u001b[0m \u001b[31m478.1 kB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Building wheels for collected packages: emoji\n","  Building wheel for emoji (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for emoji: filename=emoji-0.6.0-py3-none-any.whl size=49720 sha256=52e775ae6015bd13740a7bd1ac3918db5825eacab8d5723c3a87122377aab148\n","  Stored in directory: /root/.cache/pip/wheels/1b/bd/d9/310c33c45a553798a714e27e3b8395d37128425442b8c78e07\n","Successfully built emoji\n","Installing collected packages: emoji\n","Successfully installed emoji-0.6.0\n"]}]},{"cell_type":"code","source":["tokenizer = AutoTokenizer.from_pretrained(BERT_MODEL, use_fast=True, low_cpu_mem_usage=False)"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T07:50:07.905291Z","iopub.execute_input":"2023-05-21T07:50:07.90727Z","iopub.status.idle":"2023-05-21T07:50:10.331104Z","shell.execute_reply.started":"2023-05-21T07:50:07.907243Z","shell.execute_reply":"2023-05-21T07:50:10.330069Z"},"trusted":true,"id":"g3BkwWQmB7kg"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# simple function to batch tokenize utterances with truncation\n","def preprocess_function(examples):\n","    return tokenizer(examples[text_column], truncation=True)\n","\n","tweet_dataset = tweet_dataset.map(preprocess_function, batched=True)"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T07:50:10.332533Z","iopub.execute_input":"2023-05-21T07:50:10.332879Z","iopub.status.idle":"2023-05-21T07:57:45.447299Z","shell.execute_reply.started":"2023-05-21T07:50:10.332845Z","shell.execute_reply":"2023-05-21T07:57:45.446437Z"},"trusted":true,"id":"lXnrhwCIB7kg","colab":{"base_uri":"https://localhost:8080/","height":49,"referenced_widgets":["e8070aad71f04f60b6f5fed12dd3ee43","bc47e6a34f2a4b65b5f6f3be5358ed88","90e4fb0ab5bd43a8a50c919255a046ab","4b86bbfc558042c182a8195844bc01b0","a102afbb46c147f690e0e6d373ab1032","764c26d5827a4b4eb20d128b8611341b","7d77a08a653a412a83ee5bd47fdac960","6a543dfc2c84441ca474f6855b1201ee","e6d81812e66f4d249388eb5b12505d89","1ab2d2a4747644f0811b17c8b7b4ff40","384224450cf04c8b824de72153cda370"]},"executionInfo":{"status":"ok","timestamp":1711378990316,"user_tz":240,"elapsed":375440,"user":{"displayName":"Mei Li","userId":"04999520085843898387"}},"outputId":"ef0bf3aa-c6d0-4fa8-fa1e-a916b400365f"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/903 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e8070aad71f04f60b6f5fed12dd3ee43"}},"metadata":{}}]},{"cell_type":"code","source":["# Dataset has a built in train test split method\n","tweet_dataset = tweet_dataset.train_test_split(test_size=1-train_fraction)"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T07:57:45.448793Z","iopub.execute_input":"2023-05-21T07:57:45.449238Z","iopub.status.idle":"2023-05-21T08:02:49.583365Z","shell.execute_reply.started":"2023-05-21T07:57:45.449203Z","shell.execute_reply":"2023-05-21T08:02:49.582386Z"},"trusted":true,"id":"2GGxxuaSB7kg","colab":{"base_uri":"https://localhost:8080/","height":81,"referenced_widgets":["67f95a993ea44091b4bc71ddf567808d","b8be8df09afc4265b44e24aec52ac4b8","4bfb282e6ea449269bcce32fab6458a9","a9699e888d284822b9ad54ef322d28de","7e830089b1b849b8a6b46e8b5c53e681","927d7999dcdc4c27b73ad53167430d43","f9507c9adb92478daac92472fd8d7796","77f8d1b1603447308a4dee5731b523e1","1de7abbb73704162bf6543814ff52ca5","5ca4606e6aba40a2afa79386a08552e7","a4db10346569453d915dfa8ffa9c3e5d","0f4a76c4ec22475abb640fb719f0952d","50d4bfee4561492988fdda04dfbd3e6a","d8a8908dd7244c8786872ccb6f18c8ca","b45084b3f3f6455f9de0f87aa07cb7d3","d73b5f28990f41d68d46de2b1e45238d","b32059815e67495a85d274fe2288dbea","f8d77bdeb213445db9e0a30f25ab724b","c81f80a8bc6d4654b1b1d0270234cd68","6f9f8985b7124870a05b38da58022fae","27edbd2f53774e22981cb5448166cb49","3e2d06fe3e304026b44e47d7e4b418a9"]},"executionInfo":{"status":"ok","timestamp":1711380573259,"user_tz":240,"elapsed":257566,"user":{"displayName":"Mei Li","userId":"04999520085843898387"}},"outputId":"8f58749a-e1c6-48b7-80e3-24769f7f78ed"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/722 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"67f95a993ea44091b4bc71ddf567808d"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/181 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"0f4a76c4ec22475abb640fb719f0952d"}},"metadata":{}}]},{"cell_type":"code","source":["tweet_dataset"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T08:02:49.587599Z","iopub.execute_input":"2023-05-21T08:02:49.587918Z","iopub.status.idle":"2023-05-21T08:02:49.595804Z","shell.execute_reply.started":"2023-05-21T08:02:49.587892Z","shell.execute_reply":"2023-05-21T08:02:49.594787Z"},"trusted":true,"id":"jpdzDdHwB7kg","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1711380647766,"user_tz":240,"elapsed":127,"user":{"displayName":"Mei Li","userId":"04999520085843898387"}},"outputId":"618230e1-b4b7-4bc9-e8ac-0be0ef7c9129"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'train': Dataset(features: {'content': Value(dtype='string', id=None), 'label': Value(dtype='int64', id=None), 'input_ids': Sequence(feature=Value(dtype='int64', id=None), length=-1, id=None), 'token_type_ids': Sequence(feature=Value(dtype='int64', id=None), length=-1, id=None), 'attention_mask': Sequence(feature=Value(dtype='int64', id=None), length=-1, id=None)}, num_rows: 721608),\n"," 'test': Dataset(features: {'content': Value(dtype='string', id=None), 'label': Value(dtype='int64', id=None), 'input_ids': Sequence(feature=Value(dtype='int64', id=None), length=-1, id=None), 'token_type_ids': Sequence(feature=Value(dtype='int64', id=None), length=-1, id=None), 'attention_mask': Sequence(feature=Value(dtype='int64', id=None), length=-1, id=None)}, num_rows: 180402)}"]},"metadata":{},"execution_count":18}]},{"cell_type":"code","source":["tweet_dataset.remove_column_(text_column)  # remove the text column because we don't need to keep it in memory anymore\n","# this is not required but speeds things up a bit"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T08:02:49.59731Z","iopub.execute_input":"2023-05-21T08:02:49.598057Z","iopub.status.idle":"2023-05-21T08:02:49.609405Z","shell.execute_reply.started":"2023-05-21T08:02:49.598022Z","shell.execute_reply":"2023-05-21T08:02:49.605787Z"},"trusted":true,"id":"JgbFRqaEB7kg"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# DataCollatorWithPadding creates batch of data. It also dynamically pads text to the\n","#  length of the longest element in the batch, making them all the same length.\n","#  It's possible to pad your text in the tokenizer function with padding=True, dynamic padding is more efficient.\n","data_collator = DataCollatorWithPadding(tokenizer=tokenizer)"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T08:02:49.61186Z","iopub.execute_input":"2023-05-21T08:02:49.616136Z","iopub.status.idle":"2023-05-21T08:02:49.625457Z","shell.execute_reply.started":"2023-05-21T08:02:49.616097Z","shell.execute_reply":"2023-05-21T08:02:49.624227Z"},"trusted":true,"id":"L2LcZn2DB7kg"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["tokenizer.decode(tweet_dataset['train'][0]['input_ids'])"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T08:02:49.627084Z","iopub.execute_input":"2023-05-21T08:02:49.627436Z","iopub.status.idle":"2023-05-21T08:02:49.641219Z","shell.execute_reply.started":"2023-05-21T08:02:49.627405Z","shell.execute_reply":"2023-05-21T08:02:49.640198Z"},"trusted":true,"id":"mBrrV0EXB7kg","colab":{"base_uri":"https://localhost:8080/","height":53},"executionInfo":{"status":"ok","timestamp":1711380651417,"user_tz":240,"elapsed":143,"user":{"displayName":"Mei Li","userId":"04999520085843898387"}},"outputId":"02bf0777-caf4-4212-a986-13b254aa7146"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["'<s> \"Big news! #Microsoft might partner with #ChatGPT and #PerionNetwork set to benefit. Stay ahead of the curve with my latest insights on the potential of this partnership and its future developments on Medium. Follow me for more updates. #AI #Machinelearning #Tech #blockchain\" </s>'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":21}]},{"cell_type":"markdown","source":["<a id=\"section-model\"></a>\n","<h1 style='background:#afd873; border:10; border-radius: 25px; font-size:250%; font-weight: bold; color:black'><center>Loading and training model</center></h1>"],"metadata":{"id":"RCbOO__4B7kg"}},{"cell_type":"code","source":["model = AutoModelForSequenceClassification.from_pretrained(\n","    BERT_MODEL, num_labels=2,\n","    output_attentions = False, # Whether the model returns attentions weights.\n","    output_hidden_states = False # Whether the model returns all hidden-states.\n",")\n","\n","model.config.id2label = {0: 'NOT ENGAGED', 1: 'ENGAGED'}"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T08:02:49.64332Z","iopub.execute_input":"2023-05-21T08:02:49.643588Z","iopub.status.idle":"2023-05-21T08:02:53.663116Z","shell.execute_reply.started":"2023-05-21T08:02:49.643565Z","shell.execute_reply":"2023-05-21T08:02:53.662228Z"},"trusted":true,"id":"Zj4N8p2-B7kg","colab":{"base_uri":"https://localhost:8080/","height":105,"referenced_widgets":["f9ef1a7b74f94ebaac593325d10802db","7f5c368516d745c9a0765c79023fa4ed","478387a5af0d400aa541b2c3039f6e89","cf86aba72b854c91bd3b4f4e96d1fbf3","eacf26a1cb93499e8e2c1a54640eef9d","dc4619e9680745c883b9cb14f4b2a98e","2dd53f300ed54d8f8813b189e6c23333","2543c9c7b9ec45149e5fc3ebf306ec9f","f3e25cd49ae2438ca0eb69543a0fec8e","0b7ca8608f5e44a2b855c80a31b34449","ef5d078720a644c3b645d8fa717a6e15"]},"executionInfo":{"status":"ok","timestamp":1711380662292,"user_tz":240,"elapsed":8836,"user":{"displayName":"Mei Li","userId":"04999520085843898387"}},"outputId":"4df2a3a6-eff6-45ad-aac0-74a1c886f838"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["pytorch_model.bin:   0%|          | 0.00/543M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"f9ef1a7b74f94ebaac593325d10802db"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at vinai/bertweet-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"]}]},{"cell_type":"code","source":["# number of trainable parameters\n","print(model.num_parameters(only_trainable=True)/1e6)"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T08:02:53.664476Z","iopub.execute_input":"2023-05-21T08:02:53.664869Z","iopub.status.idle":"2023-05-21T08:02:53.672331Z","shell.execute_reply.started":"2023-05-21T08:02:53.664833Z","shell.execute_reply":"2023-05-21T08:02:53.671442Z"},"trusted":true,"id":"RaJllj8bB7kg","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1711380665140,"user_tz":240,"elapsed":100,"user":{"displayName":"Mei Li","userId":"04999520085843898387"}},"outputId":"4ecf5cf2-1702-4396-a495-20d6dfc19bf2"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["134.901506\n"]}]},{"cell_type":"code","source":["from datasets import load_metric\n","\n","metric = load_metric(\"accuracy\")\n","\n","def compute_metrics(eval_pred):\n","    logits, labels = eval_pred\n","    predictions = np.argmax(logits, axis=-1)\n","    return metric.compute(predictions=predictions, references=labels)"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T08:02:53.673922Z","iopub.execute_input":"2023-05-21T08:02:53.674968Z","iopub.status.idle":"2023-05-21T08:02:54.326718Z","shell.execute_reply.started":"2023-05-21T08:02:53.674935Z","shell.execute_reply":"2023-05-21T08:02:54.325866Z"},"trusted":true,"id":"oFnVOx0lB7kh","colab":{"base_uri":"https://localhost:8080/","height":177,"referenced_widgets":["9d9cd5279a57407b860c95af5b229a48","896b8dfd7c4f4b71b2a6745beed62eba","72633ee9c2564491842f3b67cbd773a2","51cad8216702411a90e411954d437107","b97722b9e7a944da8d84c1c623d3c0a3","7058a0cf32774b398f23c36634c48edc","f4f6d3423cd5440eb42a3c35f4d42c8f","bea7fed160e14bc3b361ca766832fbef","9f33c4204db24c55a3d86edeeba7457d","f894846883ad41aebce5a5f3a3c2c721","1eea605605d24707a48e9c3c962d084f"]},"executionInfo":{"status":"ok","timestamp":1711380667140,"user_tz":240,"elapsed":614,"user":{"displayName":"Mei Li","userId":"04999520085843898387"}},"outputId":"2e631d73-b00b-4757-9bcd-22b901a6dd0b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["<ipython-input-24-e1ee7db0da93>:3: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate\n","  metric = load_metric(\"accuracy\")\n","/usr/local/lib/python3.10/dist-packages/datasets/load.py:756: FutureWarning: The repository for accuracy contains custom code which must be executed to correctly load the metric. You can inspect the repository content at https://raw.githubusercontent.com/huggingface/datasets/2.18.0/metrics/accuracy/accuracy.py\n","You can avoid this message in future by passing the argument `trust_remote_code=True`.\n","Passing `trust_remote_code=True` will be mandatory to load this metric from the next major release of `datasets`.\n","  warnings.warn(\n"]},{"output_type":"display_data","data":{"text/plain":["Downloading builder script:   0%|          | 0.00/1.65k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"9d9cd5279a57407b860c95af5b229a48"}},"metadata":{}}]},{"cell_type":"code","source":["!pip install transformers[torch]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2Vd75tuRPPc3","executionInfo":{"status":"ok","timestamp":1711381590201,"user_tz":240,"elapsed":850909,"user":{"displayName":"Mei Li","userId":"04999520085843898387"}},"outputId":"5c6da394-8cbe-410d-9774-a4795e233662"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: transformers[torch] in /usr/local/lib/python3.10/dist-packages (4.38.2)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (3.13.1)\n","Requirement already satisfied: huggingface-hub<1.0,>=0.19.3 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (0.20.3)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (1.25.2)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (23.2)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (6.0.1)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (2023.12.25)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (2.31.0)\n","Requirement already satisfied: tokenizers<0.19,>=0.14 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (0.15.2)\n","Requirement already satisfied: safetensors>=0.4.1 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (0.4.2)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (4.66.2)\n","Requirement already satisfied: torch in /usr/local/lib/python3.10/dist-packages (from transformers[torch]) (2.2.1+cu121)\n","Collecting accelerate>=0.21.0 (from transformers[torch])\n","  Downloading accelerate-0.28.0-py3-none-any.whl (290 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m290.1/290.1 kB\u001b[0m \u001b[31m1.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from accelerate>=0.21.0->transformers[torch]) (5.9.5)\n","Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.19.3->transformers[torch]) (2023.6.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.19.3->transformers[torch]) (4.10.0)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch->transformers[torch]) (1.12)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch->transformers[torch]) (3.2.1)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch->transformers[torch]) (3.1.3)\n","Collecting nvidia-cuda-nvrtc-cu12==12.1.105 (from torch->transformers[torch])\n","  Downloading nvidia_cuda_nvrtc_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (23.7 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m23.7/23.7 MB\u001b[0m \u001b[31m8.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting nvidia-cuda-runtime-cu12==12.1.105 (from torch->transformers[torch])\n","  Downloading nvidia_cuda_runtime_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (823 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m823.6/823.6 kB\u001b[0m \u001b[31m28.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting nvidia-cuda-cupti-cu12==12.1.105 (from torch->transformers[torch])\n","  Downloading nvidia_cuda_cupti_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (14.1 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m14.1/14.1 MB\u001b[0m \u001b[31m11.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting nvidia-cudnn-cu12==8.9.2.26 (from torch->transformers[torch])\n","  Downloading nvidia_cudnn_cu12-8.9.2.26-py3-none-manylinux1_x86_64.whl (731.7 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m731.7/731.7 MB\u001b[0m \u001b[31m673.4 kB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting nvidia-cublas-cu12==12.1.3.1 (from torch->transformers[torch])\n","  Downloading nvidia_cublas_cu12-12.1.3.1-py3-none-manylinux1_x86_64.whl (410.6 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m410.6/410.6 MB\u001b[0m \u001b[31m1.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting nvidia-cufft-cu12==11.0.2.54 (from torch->transformers[torch])\n","  Downloading nvidia_cufft_cu12-11.0.2.54-py3-none-manylinux1_x86_64.whl (121.6 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m121.6/121.6 MB\u001b[0m \u001b[31m1.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting nvidia-curand-cu12==10.3.2.106 (from torch->transformers[torch])\n","  Downloading nvidia_curand_cu12-10.3.2.106-py3-none-manylinux1_x86_64.whl (56.5 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m56.5/56.5 MB\u001b[0m \u001b[31m1.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting nvidia-cusolver-cu12==11.4.5.107 (from torch->transformers[torch])\n","  Downloading nvidia_cusolver_cu12-11.4.5.107-py3-none-manylinux1_x86_64.whl (124.2 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m124.2/124.2 MB\u001b[0m \u001b[31m2.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting nvidia-cusparse-cu12==12.1.0.106 (from torch->transformers[torch])\n","  Downloading nvidia_cusparse_cu12-12.1.0.106-py3-none-manylinux1_x86_64.whl (196.0 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m196.0/196.0 MB\u001b[0m \u001b[31m1.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting nvidia-nccl-cu12==2.19.3 (from torch->transformers[torch])\n","  Downloading nvidia_nccl_cu12-2.19.3-py3-none-manylinux1_x86_64.whl (166.0 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m166.0/166.0 MB\u001b[0m \u001b[31m2.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting nvidia-nvtx-cu12==12.1.105 (from torch->transformers[torch])\n","  Downloading nvidia_nvtx_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (99 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m99.1/99.1 kB\u001b[0m \u001b[31m4.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: triton==2.2.0 in /usr/local/lib/python3.10/dist-packages (from torch->transformers[torch]) (2.2.0)\n","Collecting nvidia-nvjitlink-cu12 (from nvidia-cusolver-cu12==11.4.5.107->torch->transformers[torch])\n","  Downloading nvidia_nvjitlink_cu12-12.4.99-py3-none-manylinux2014_x86_64.whl (21.1 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m21.1/21.1 MB\u001b[0m \u001b[31m2.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->transformers[torch]) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->transformers[torch]) (3.6)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->transformers[torch]) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->transformers[torch]) (2024.2.2)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch->transformers[torch]) (2.1.5)\n","Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy->torch->transformers[torch]) (1.3.0)\n","Installing collected packages: nvidia-nvtx-cu12, nvidia-nvjitlink-cu12, nvidia-nccl-cu12, nvidia-curand-cu12, nvidia-cufft-cu12, nvidia-cuda-runtime-cu12, nvidia-cuda-nvrtc-cu12, nvidia-cuda-cupti-cu12, nvidia-cublas-cu12, nvidia-cusparse-cu12, nvidia-cudnn-cu12, nvidia-cusolver-cu12, accelerate\n","Successfully installed accelerate-0.28.0 nvidia-cublas-cu12-12.1.3.1 nvidia-cuda-cupti-cu12-12.1.105 nvidia-cuda-nvrtc-cu12-12.1.105 nvidia-cuda-runtime-cu12-12.1.105 nvidia-cudnn-cu12-8.9.2.26 nvidia-cufft-cu12-11.0.2.54 nvidia-curand-cu12-10.3.2.106 nvidia-cusolver-cu12-11.4.5.107 nvidia-cusparse-cu12-12.1.0.106 nvidia-nccl-cu12-2.19.3 nvidia-nvjitlink-cu12-12.4.99 nvidia-nvtx-cu12-12.1.105\n"]}]},{"cell_type":"markdown","source":[],"metadata":{"id":"khrCXIlvSyF8"}},{"cell_type":"code","source":["!pip install accelerate==0.21.0"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"K4wz8EyfSzCl","executionInfo":{"status":"ok","timestamp":1711381708605,"user_tz":240,"elapsed":16476,"user":{"displayName":"Mei Li","userId":"04999520085843898387"}},"outputId":"644c6eb6-9108-4723-dac1-a852e07b9b9b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting accelerate==0.21.0\n","  Downloading accelerate-0.21.0-py3-none-any.whl (244 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m244.2/244.2 kB\u001b[0m \u001b[31m2.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from accelerate==0.21.0) (1.25.2)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from accelerate==0.21.0) (23.2)\n","Requirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from accelerate==0.21.0) (5.9.5)\n","Requirement already satisfied: pyyaml in /usr/local/lib/python3.10/dist-packages (from accelerate==0.21.0) (6.0.1)\n","Requirement already satisfied: torch>=1.10.0 in /usr/local/lib/python3.10/dist-packages (from accelerate==0.21.0) (2.2.1+cu121)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate==0.21.0) (3.13.1)\n","Requirement already satisfied: typing-extensions>=4.8.0 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate==0.21.0) (4.10.0)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate==0.21.0) (1.12)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate==0.21.0) (3.2.1)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate==0.21.0) (3.1.3)\n","Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate==0.21.0) (2023.6.0)\n","Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.1.105 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate==0.21.0) (12.1.105)\n","Requirement already satisfied: nvidia-cuda-runtime-cu12==12.1.105 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate==0.21.0) (12.1.105)\n","Requirement already satisfied: nvidia-cuda-cupti-cu12==12.1.105 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate==0.21.0) (12.1.105)\n","Requirement already satisfied: nvidia-cudnn-cu12==8.9.2.26 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate==0.21.0) (8.9.2.26)\n","Requirement already satisfied: nvidia-cublas-cu12==12.1.3.1 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate==0.21.0) (12.1.3.1)\n","Requirement already satisfied: nvidia-cufft-cu12==11.0.2.54 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate==0.21.0) (11.0.2.54)\n","Requirement already satisfied: nvidia-curand-cu12==10.3.2.106 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate==0.21.0) (10.3.2.106)\n","Requirement already satisfied: nvidia-cusolver-cu12==11.4.5.107 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate==0.21.0) (11.4.5.107)\n","Requirement already satisfied: nvidia-cusparse-cu12==12.1.0.106 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate==0.21.0) (12.1.0.106)\n","Requirement already satisfied: nvidia-nccl-cu12==2.19.3 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate==0.21.0) (2.19.3)\n","Requirement already satisfied: nvidia-nvtx-cu12==12.1.105 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate==0.21.0) (12.1.105)\n","Requirement already satisfied: triton==2.2.0 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate==0.21.0) (2.2.0)\n","Requirement already satisfied: nvidia-nvjitlink-cu12 in /usr/local/lib/python3.10/dist-packages (from nvidia-cusolver-cu12==11.4.5.107->torch>=1.10.0->accelerate==0.21.0) (12.4.99)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=1.10.0->accelerate==0.21.0) (2.1.5)\n","Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy->torch>=1.10.0->accelerate==0.21.0) (1.3.0)\n","Installing collected packages: accelerate\n","  Attempting uninstall: accelerate\n","    Found existing installation: accelerate 0.28.0\n","    Uninstalling accelerate-0.28.0:\n","      Successfully uninstalled accelerate-0.28.0\n","Successfully installed accelerate-0.21.0\n"]}]},{"cell_type":"code","source":["training_args = TrainingArguments(\n","    output_dir=model_saved_path,\n","    logging_dir='./logs',\n","    num_train_epochs=num_train_epochs,\n","    per_device_train_batch_size=batch_size,\n","    per_device_eval_batch_size=batch_size,\n","    logging_strategy='steps',\n","    logging_first_step=True,\n","    load_best_model_at_end=True,\n","    logging_steps=1,\n","    evaluation_strategy='epoch',\n","    warmup_steps=warmup_steps,\n","    weight_decay=weight_decay,\n","    eval_steps=1,\n","    save_strategy='epoch',\n","    report_to=\"mlflow\",  # log to mlflow\n",")\n","\n","# Define the trainer:\n","# instantiate the trainer class and check for available devices\n","trainer = Trainer(\n","    model=model,\n","    args=training_args,\n","    compute_metrics=compute_metrics,\n","    train_dataset=tweet_dataset['train'],\n","    eval_dataset=tweet_dataset['test'],\n","    data_collator=data_collator\n",")"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T08:02:54.328062Z","iopub.execute_input":"2023-05-21T08:02:54.328493Z","iopub.status.idle":"2023-05-21T08:02:59.356032Z","shell.execute_reply.started":"2023-05-21T08:02:54.328459Z","shell.execute_reply":"2023-05-21T08:02:59.354761Z"},"trusted":true,"id":"KfK-eGSrB7kh","colab":{"base_uri":"https://localhost:8080/","height":548},"executionInfo":{"status":"error","timestamp":1711381764674,"user_tz":240,"elapsed":266,"user":{"displayName":"Mei Li","userId":"04999520085843898387"}},"outputId":"4e36f264-231b-41ed-aff0-2ac9888901a5"},"execution_count":null,"outputs":[{"output_type":"error","ename":"ImportError","evalue":"Using the `Trainer` with `PyTorch` requires `accelerate>=0.21.0`: Please run `pip install transformers[torch]` or `pip install accelerate -U`","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mImportError\u001b[0m                               Traceback (most recent call last)","\u001b[0;32m<ipython-input-35-5b02108acb31>\u001b[0m in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m training_args = TrainingArguments(\n\u001b[0m\u001b[1;32m      2\u001b[0m     \u001b[0moutput_dir\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mmodel_saved_path\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m     \u001b[0mlogging_dir\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'./logs'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m     \u001b[0mnum_train_epochs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mnum_train_epochs\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m     \u001b[0mper_device_train_batch_size\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mbatch_size\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/training_args.py\u001b[0m in \u001b[0;36m__init__\u001b[0;34m(self, output_dir, overwrite_output_dir, do_train, do_eval, do_predict, evaluation_strategy, prediction_loss_only, per_device_train_batch_size, per_device_eval_batch_size, per_gpu_train_batch_size, per_gpu_eval_batch_size, gradient_accumulation_steps, eval_accumulation_steps, eval_delay, learning_rate, weight_decay, adam_beta1, adam_beta2, adam_epsilon, max_grad_norm, num_train_epochs, max_steps, lr_scheduler_type, lr_scheduler_kwargs, warmup_ratio, warmup_steps, log_level, log_level_replica, log_on_each_node, logging_dir, logging_strategy, logging_first_step, logging_steps, logging_nan_inf_filter, save_strategy, save_steps, save_total_limit, save_safetensors, save_on_each_node, save_only_model, no_cuda, use_cpu, use_mps_device, seed, data_seed, jit_mode_eval, use_ipex, bf16, fp16, fp16_opt_level, half_precision_backend, bf16_full_eval, fp16_full_eval, tf32, local_rank, ddp_backend, tpu_num_cores, tpu_metrics_debug, debug, dataloader_drop_last, eval_steps, dataloader_num_workers, dataloader_prefetch_factor, past_index, run_name, disable_tqdm, remove_unused_columns, label_names, load_best_model_at_end, metric_for_best_model, greater_is_better, ignore_data_skip, fsdp, fsdp_min_num_params, fsdp_config, fsdp_transformer_layer_cls_to_wrap, accelerator_config, deepspeed, label_smoothing_factor, optim, optim_args, adafactor, group_by_length, length_column_name, report_to, ddp...\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/training_args.py\u001b[0m in \u001b[0;36m__post_init__\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   1526\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mframework\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;34m\"pt\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1527\u001b[0m             \u001b[0;32mand\u001b[0m \u001b[0mis_torch_available\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1528\u001b[0;31m             \u001b[0;32mand\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdevice\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtype\u001b[0m \u001b[0;34m!=\u001b[0m \u001b[0;34m\"cuda\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1529\u001b[0m             \u001b[0;32mand\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdevice\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtype\u001b[0m \u001b[0;34m!=\u001b[0m \u001b[0;34m\"npu\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1530\u001b[0m             \u001b[0;32mand\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdevice\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtype\u001b[0m \u001b[0;34m!=\u001b[0m \u001b[0;34m\"xpu\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/training_args.py\u001b[0m in \u001b[0;36mdevice\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   1993\u001b[0m         \"\"\"\n\u001b[1;32m   1994\u001b[0m         \u001b[0mrequires_backends\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m\"torch\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1995\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_setup_devices\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1996\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1997\u001b[0m     \u001b[0;34m@\u001b[0m\u001b[0mproperty\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/utils/generic.py\u001b[0m in \u001b[0;36m__get__\u001b[0;34m(self, obj, objtype)\u001b[0m\n\u001b[1;32m     54\u001b[0m         \u001b[0mcached\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mgetattr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mobj\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mattr\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     55\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mcached\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 56\u001b[0;31m             \u001b[0mcached\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfget\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mobj\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     57\u001b[0m             \u001b[0msetattr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mobj\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mattr\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcached\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     58\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mcached\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/training_args.py\u001b[0m in \u001b[0;36m_setup_devices\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   1903\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mis_sagemaker_mp_enabled\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1904\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mis_accelerate_available\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1905\u001b[0;31m                 raise ImportError(\n\u001b[0m\u001b[1;32m   1906\u001b[0m                     \u001b[0;34mf\"Using the `Trainer` with `PyTorch` requires `accelerate>={ACCELERATE_MIN_VERSION}`: \"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1907\u001b[0m                     \u001b[0;34m\"Please run `pip install transformers[torch]` or `pip install accelerate -U`\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mImportError\u001b[0m: Using the `Trainer` with `PyTorch` requires `accelerate>=0.21.0`: Please run `pip install transformers[torch]` or `pip install accelerate -U`","","\u001b[0;31m---------------------------------------------------------------------------\u001b[0;32m\nNOTE: If your import is failing due to a missing package, you can\nmanually install dependencies using either !pip or !apt.\n\nTo view examples of installing some common dependencies, click the\n\"Open Examples\" button below.\n\u001b[0;31m---------------------------------------------------------------------------\u001b[0m\n"],"errorDetails":{"actions":[{"action":"open_url","actionText":"Open Examples","url":"/notebooks/snippets/importing_libraries.ipynb"}]}}]},{"cell_type":"code","source":["# Get initial metrics\n","trainer.evaluate()"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T08:02:59.35737Z","iopub.execute_input":"2023-05-21T08:02:59.357735Z","iopub.status.idle":"2023-05-21T08:11:35.611535Z","shell.execute_reply.started":"2023-05-21T08:02:59.357685Z","shell.execute_reply":"2023-05-21T08:11:35.610626Z"},"trusted":true,"id":"FCiFT7GzB7kh"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["trainer.train()"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T08:11:35.613051Z","iopub.execute_input":"2023-05-21T08:11:35.614043Z","iopub.status.idle":"2023-05-21T11:49:46.337524Z","shell.execute_reply.started":"2023-05-21T08:11:35.614009Z","shell.execute_reply":"2023-05-21T11:49:46.336631Z"},"trusted":true,"id":"9FNTmsx2B7kh"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["trainer.evaluate()"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T11:49:46.338889Z","iopub.execute_input":"2023-05-21T11:49:46.339736Z","iopub.status.idle":"2023-05-21T11:58:20.678672Z","shell.execute_reply.started":"2023-05-21T11:49:46.339686Z","shell.execute_reply":"2023-05-21T11:58:20.67759Z"},"trusted":true,"id":"1kOCmQqQB7kh"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["trainer.save_model()"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T11:58:20.683258Z","iopub.execute_input":"2023-05-21T11:58:20.684344Z","iopub.status.idle":"2023-05-21T11:58:21.567486Z","shell.execute_reply.started":"2023-05-21T11:58:20.684287Z","shell.execute_reply":"2023-05-21T11:58:21.56651Z"},"trusted":true,"id":"vS51yBn9B7kh"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["tokenizer.save_vocabulary(save_directory=model_saved_path)"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T11:58:21.568773Z","iopub.execute_input":"2023-05-21T11:58:21.571262Z","iopub.status.idle":"2023-05-21T11:58:21.592373Z","shell.execute_reply.started":"2023-05-21T11:58:21.571235Z","shell.execute_reply":"2023-05-21T11:58:21.59171Z"},"trusted":true,"id":"XR59cSuiB7kh"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# make a classification pipeline\n","pipe = pipeline(\"text-classification\", model_saved_path, tokenizer=BERT_MODEL)\n","sample_tweet = '''Why do employees leave companies — analysis of IBM employee data https://link.medium.com/jMw17FDm8yb'''\n","pipe(sample_tweet, top_k=None)"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T11:58:21.594143Z","iopub.execute_input":"2023-05-21T11:58:21.594856Z","iopub.status.idle":"2023-05-21T11:58:24.477736Z","shell.execute_reply.started":"2023-05-21T11:58:21.594821Z","shell.execute_reply":"2023-05-21T11:58:24.476669Z"},"trusted":true,"id":"wGmmuOy8B7kh"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# use the upper cased version\n","sample_tweet2 = sample_tweet.upper()\n","pipe(sample_tweet2, top_k=None)"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T11:58:24.479415Z","iopub.execute_input":"2023-05-21T11:58:24.479803Z","iopub.status.idle":"2023-05-21T11:58:24.60584Z","shell.execute_reply.started":"2023-05-21T11:58:24.479769Z","shell.execute_reply":"2023-05-21T11:58:24.604716Z"},"trusted":true,"id":"iKXdESthB7kh"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["sample_tweet4 = '''Use ChatGPT right now says Elon'''\n","pipe(sample_tweet4, top_k=None)"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T11:58:24.611378Z","iopub.execute_input":"2023-05-21T11:58:24.611675Z","iopub.status.idle":"2023-05-21T11:58:24.72627Z","shell.execute_reply.started":"2023-05-21T11:58:24.611643Z","shell.execute_reply":"2023-05-21T11:58:24.725177Z"},"trusted":true,"id":"IGyoTt2GB7kh"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# finally, save the model to Huggingface\n","from huggingface_hub import notebook_login\n","notebook_login()"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T11:58:24.727839Z","iopub.execute_input":"2023-05-21T11:58:24.728657Z","iopub.status.idle":"2023-05-21T11:58:24.761788Z","shell.execute_reply.started":"2023-05-21T11:58:24.728621Z","shell.execute_reply":"2023-05-21T11:58:24.76087Z"},"trusted":true,"id":"f3qsP6RmB7kh"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from huggingface_hub import HfApi\n","api = HfApi()\n","# api.create_repo(repo_id)"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T11:58:57.309027Z","iopub.execute_input":"2023-05-21T11:58:57.309599Z","iopub.status.idle":"2023-05-21T11:58:57.31356Z","shell.execute_reply.started":"2023-05-21T11:58:57.309563Z","shell.execute_reply":"2023-05-21T11:58:57.312688Z"},"trusted":true,"id":"TLv16eamB7kh"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["api.upload_folder(\n","    folder_path=model_saved_path,\n","    path_in_repo = \".\",\n","    repo_id=repo_id,\n","    repo_type=\"model\"\n",")"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T11:59:00.816025Z","iopub.execute_input":"2023-05-21T11:59:00.816754Z","iopub.status.idle":"2023-05-21T12:00:40.147207Z","shell.execute_reply.started":"2023-05-21T11:59:00.8167Z","shell.execute_reply":"2023-05-21T12:00:40.146251Z"},"trusted":true,"id":"R3p01x7sB7kh"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# sample tweets about ChatGPT\n","import pandas as pd\n","import torch\n","from transformers import AutoTokenizer, AutoModelForSequenceClassification\n","pd.set_option('display.width', 1000)\n","pd.set_option('display.max_colwidth', 100)\n","tokenizer = AutoTokenizer.from_pretrained(repo_id)\n","model = AutoModelForSequenceClassification.from_pretrained(repo_id)\n","\n","tweets = [\n","\"Unlock the power of language with ChatGPT! 🚀✨\",\n","\"Need a creative spark? ChatGPT is here to ignite your imagination! 🔥\",\n","\"Discover the limitless possibilities of conversational AI with ChatGPT.\",\n","\"Get ready to have your mind blown by ChatGPT's incredible language capabilities!\",\n","\"Want to have a chat with an AI? ChatGPT is your go-to companion!\",\n","\"Experience the future of natural language processing with ChatGPT.\",\n","\"ChatGPT is your personal AI assistant, ready to help and entertain!\",\n","\"Say hello to ChatGPT, your friendly neighborhood language model. 👋\",\n","\"Need some writing inspiration? ChatGPT has got you covered!\",\n","\"Say goodbye to writer's block and let ChatGPT unleash your creativity.\",\n","\"ChatGPT: Making AI conversations feel more human, one interaction at a time.\",\n","\"Join the conversation with ChatGPT and see where it takes you!\",\n","\"Interact with ChatGPT and embark on a journey of knowledge and discovery.\",\n","\"Ask ChatGPT anything and prepare to be amazed by its insightful responses!\",\n","\"Discover the power of ChatGPT and its ability to understand and generate text.\",\n","\"ChatGPT is the bridge between humans and artificial intelligence. 🌉\",\n","\"Experience the next level of virtual communication with ChatGPT.\",\n","\"Engage in thought-provoking discussions with ChatGPT and broaden your horizons.\",\n","\"Let ChatGPT be your language companion, always there to lend a helping hand.\",\n","\"Experience the magic of ChatGPT as it brings words to life!\",\n","\"Have a conversation that feels like it's with a human, thanks to ChatGPT's natural language understanding.\"\n","]\n","\n","def get_sorted_results(tweets):\n","    # Tokenize the input texts\n","    encoded_inputs = tokenizer(tweets, padding=True, return_tensors=\"pt\")\n","\n","    # Perform inference on the tokenized inputs\n","    with torch.no_grad():\n","        logits = model(**encoded_inputs).logits\n","\n","    # Get the predicted class probabilities\n","    probs = torch.softmax(logits, dim=1).squeeze()\n","    last_class_probs = probs[:, -1].tolist()\n","\n","    # Create a DataFrame to store the results\n","    results_df = pd.DataFrame({\n","        \"Title\": tweets,\n","        \"Engaged probability\": last_class_probs,\n","    })\n","\n","    # Sort the resulting DataFrame based on predicted probability\n","    return results_df.sort_values(\"Engaged probability\", ascending=False)\n","\n","get_sorted_results(tweets)"],"metadata":{"execution":{"iopub.status.busy":"2023-05-21T12:00:58.734719Z","iopub.execute_input":"2023-05-21T12:00:58.735109Z","iopub.status.idle":"2023-05-21T12:01:13.465753Z","shell.execute_reply.started":"2023-05-21T12:00:58.73508Z","shell.execute_reply":"2023-05-21T12:01:13.46478Z"},"trusted":true,"id":"1RplvqhgB7ki"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"Ibd-bWxCB7ki"},"execution_count":null,"outputs":[]}]}